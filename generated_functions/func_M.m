function M = func_M(in1,in2)
%FUNC_M
%    M = FUNC_M(IN1,IN2)

%    This function was generated by the Symbolic Math Toolbox version 8.5.
%    13-Sep-2021 16:35:51

Ia_1 = in2(8,:);
Ia_2 = in2(9,:);
Ia_3 = in2(10,:);
Ib_1 = in2(5,:);
Ib_2 = in2(6,:);
Ib_3 = in2(7,:);
Iw_1 = in2(11,:);
Iw_2 = in2(12,:);
Iw_3 = in2(13,:);
L1_L_1 = in2(14,:);
L1_L_3 = in2(16,:);
L1_R_1 = in2(23,:);
L1_R_3 = in2(25,:);
L2_L_1 = in2(17,:);
L2_L_2 = in2(18,:);
L2_L_3 = in2(19,:);
L2_R_1 = in2(26,:);
L2_R_2 = in2(27,:);
L2_R_3 = in2(28,:);
L3_L_1 = in2(20,:);
L3_L_2 = in2(21,:);
L3_L_3 = in2(22,:);
L3_R_1 = in2(29,:);
L3_R_2 = in2(30,:);
L3_R_3 = in2(31,:);
ma = in2(2,:);
mb = in2(1,:);
mw = in2(3,:);
qe_L = in1(9,:);
qe_R = in1(13,:);
qf_L = in1(10,:);
qf_R = in1(14,:);
qm_L = in1(8,:);
qm_R = in1(12,:);
qp_L = in1(7,:);
qp_R = in1(11,:);
qx = in1(4,:);
qy = in1(5,:);
M = reshape([ma.*2.0+mb+mw.*2.0,0.0,0.0,0.0,(mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy))-L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy))-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L)).*2.0))./2.0+(mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy))-L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy))-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R)).*2.0))./2.0-(ma.*(sin(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0).*2.0-cos(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0).*2.0))./2.0-(ma.*(sin(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0).*2.0-cos(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0).*2.0))./2.0,0.0,mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L)).*2.0-L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L)))-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L)).*2.0).*(-1.0./2.0)-(ma.*(cos(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0).*2.0-sin(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0).*2.0))./2.0,mw.*(L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L))+L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L))-L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L))+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L)).*2.0).*(-1.0./2.0)-ma.*cos(qy).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0),mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))-L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L)))).*(-1.0./2.0),mw.*(L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L))+L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy))).*(-1.0./2.0),mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R)).*2.0-L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R)))-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R)).*2.0).*(-1.0./2.0)-(ma.*(cos(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0).*2.0-sin(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0).*2.0))./2.0,mw.*(L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R))+L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R))-L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R))+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R)).*2.0).*(-1.0./2.0)-ma.*cos(qy).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0),mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))-L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R)))).*(-1.0./2.0),mw.*(L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R))+L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy))).*(-1.0./2.0),0.0,ma.*2.0+mb+mw.*2.0,0.0,0.0,0.0,0.0,mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L))+L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L))+L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L))+L2_L_3.*cos(qm_L).*cos(qp_L).*2.0+L2_L_2.*cos(qm_L).*sin(qp_L).*2.0).*(-1.0./2.0)-(ma.*(L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)))./2.0,(mw.*(L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L))-L2_L_1.*cos(qm_L).*2.0+L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L))+L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))-L2_L_2.*cos(qp_L).*sin(qm_L).*2.0+L2_L_3.*sin(qm_L).*sin(qp_L).*2.0))./2.0-(ma.*(L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L)))./2.0,mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L))+L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L))+L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L))).*(-1.0./2.0),mw.*(L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L))-L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L))).*(-1.0./2.0),(mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R))+L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R))+L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R))+L2_R_3.*cos(qm_R).*cos(qp_R).*2.0+L2_R_2.*cos(qm_R).*sin(qp_R).*2.0))./2.0+(ma.*(L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)))./2.0,mw.*(L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R))-L2_R_1.*cos(qm_R).*2.0+L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R))+L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-L2_R_2.*cos(qp_R).*sin(qm_R).*2.0+L2_R_3.*sin(qm_R).*sin(qp_R).*2.0).*(-1.0./2.0)+(ma.*(L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R)))./2.0,(mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R))+L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R))+L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R))))./2.0,(mw.*(L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R))-L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R))))./2.0,0.0,0.0,ma.*2.0+mb+mw.*2.0,0.0,ma.*(sin(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0).*2.0+cos(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0).*2.0).*(-1.0./2.0)-(ma.*(sin(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0).*2.0+cos(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0).*2.0))./2.0-(mw.*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L)).*2.0-L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy))+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))))./2.0-(mw.*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R)).*2.0-L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy))+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))))./2.0,0.0,(mw.*(-L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))-L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))+L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy)))+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L)).*2.0+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L)).*2.0))./2.0+(ma.*(sin(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0).*2.0+cos(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0).*2.0))./2.0,(mw.*(L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy))+L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy))-L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy))+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L)).*2.0))./2.0+ma.*sin(qy).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0),mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))-L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy)))).*(-1.0./2.0),(mw.*(L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy))+L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy))))./2.0,(mw.*(-L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))-L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))+L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy)))+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R)).*2.0+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R)).*2.0))./2.0+(ma.*(sin(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0).*2.0+cos(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0).*2.0))./2.0,(mw.*(L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy))+L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy))-L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy))+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R)).*2.0))./2.0+ma.*sin(qy).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0),mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))-L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy)))).*(-1.0./2.0),(mw.*(L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy))+L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy))))./2.0,0.0,0.0,0.0,Ib_1+Iw_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)).^2+Iw_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)).^2+Iw_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)).^2+Iw_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)).^2+Iw_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)).^2+Iw_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)).^2+Ia_1.*cos(qm_L).^2+Ia_1.*cos(qm_R).^2+Ia_2.*cos(qp_L).^2.*sin(qm_L).^2+Ia_2.*cos(qp_R).^2.*sin(qm_R).^2+Ia_3.*sin(qm_L).^2.*sin(qp_L).^2+Ia_3.*sin(qm_R).^2.*sin(qp_R).^2,-Iw_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L))+Iw_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R))+Iw_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L))+Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R))-Ia_2.*cos(qp_L).*sin(qm_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))-Ia_2.*cos(qp_R).*sin(qm_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))-Ia_1.*cos(conj(qx)).*cos(qm_L).*sin(qm_L)+Ia_1.*cos(conj(qx)).*cos(qm_R).*sin(qm_R)+Ia_3.*sin(qm_L).*sin(qp_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+Ia_3.*sin(qm_R).*sin(qp_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R)),-Ib_1.*sin(conj(qy))-Ia_1.*cos(qm_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-Ia_1.*cos(qm_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))-Iw_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)))+Iw_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)))+Ia_2.*cos(qp_L).*sin(qm_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))-Ia_2.*cos(qp_R).*sin(qm_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-Ia_3.*sin(qm_L).*sin(qp_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-Ia_3.*sin(qm_R).*sin(qp_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)),Ia_1.*cos(qm_L).*(cos(qm_L).^2+sin(qm_L).^2)-Iw_1.*cos(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))+Iw_3.*sin(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)),Iw_3.*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L))-Iw_1.*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))+Iw_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)).*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L))-Ia_2.*cos(qp_L).*sin(qm_L).*sin(qp_L)+Ia_3.*cos(qp_L).*sin(qm_L).*sin(qp_L),-Iw_1.*cos(qf_L).*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))+Iw_3.*sin(qf_L).*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)),Iw_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)).*(cos(qe_L).^2+sin(qe_L).^2),-Ia_1.*cos(qm_R).*(cos(qm_R).^2+sin(qm_R).^2)+Iw_1.*cos(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-Iw_3.*sin(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)),-Iw_3.*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R))+Iw_1.*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-Iw_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)).*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R))+Ia_2.*cos(qp_R).*sin(qm_R).*sin(qp_R)-Ia_3.*cos(qp_R).*sin(qm_R).*sin(qp_R),Iw_1.*cos(qf_R).*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-Iw_3.*sin(qf_R).*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)),-Iw_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)).*(cos(qe_R).^2+sin(qe_R).^2),(mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy))-L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy))-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L)).*2.0))./2.0+(mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy))-L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy))-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R)).*2.0))./2.0-(ma.*(sin(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0).*2.0-cos(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0).*2.0))./2.0-(ma.*(sin(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0).*2.0-cos(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0).*2.0))./2.0,0.0,ma.*(sin(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0).*2.0+cos(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0).*2.0).*(-1.0./2.0)-(ma.*(sin(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0).*2.0+cos(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0).*2.0))./2.0-(mw.*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L)).*2.0-L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy))+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))))./2.0-(mw.*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R)).*2.0-L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy))+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))))./2.0,-Iw_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L))+Iw_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R))+Iw_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L))+Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R))-Ia_2.*cos(qp_L).*sin(qm_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))-Ia_2.*cos(qp_R).*sin(qm_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))-Ia_1.*cos(conj(qx)).*cos(qm_L).*sin(qm_L)+Ia_1.*cos(conj(qx)).*cos(qm_R).*sin(qm_R)+Ia_3.*sin(qm_L).*sin(qp_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+Ia_3.*sin(qm_R).*sin(qp_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R)),(mw.*((sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).^2.*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).^2.*2.0))./2.0+(mw.*((sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).^2.*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).^2.*2.0))./2.0+Ia_2.*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)).^2+Ia_3.*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L)).^2+Ia_2.*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)).^2+Ia_3.*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R)).^2+Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).^2+Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).^2+Ib_2.*cos(conj(qx)).^2+Iw_3.*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L)).^2+Iw_3.*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R)).^2+Ib_3.*sin(conj(qx)).^2+Iw_1.*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))).^2+Iw_1.*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))).^2+(ma.*((sin(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)+cos(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)).^2.*2.0+(sin(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)-cos(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)).^2.*2.0))./2.0+(ma.*((sin(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)+cos(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)).^2.*2.0+(sin(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)-cos(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)).^2.*2.0))./2.0+Ia_1.*cos(conj(qx)).^2.*sin(qm_L).^2+Ia_1.*cos(conj(qx)).^2.*sin(qm_R).^2,Iw_3.*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L)).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R)).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_1.*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))+Iw_1.*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)))+Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)))-Ia_2.*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+Ia_2.*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-Ia_3.*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L)).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-Ia_3.*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R)).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+Ib_2.*cos(conj(qx)).*cos(conj(qy)).*sin(conj(qx))-Ib_3.*cos(conj(qx)).*cos(conj(qy)).*sin(conj(qx))+Ia_1.*cos(conj(qx)).*sin(qm_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-Ia_1.*cos(conj(qx)).*sin(qm_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R)),ma.*((sin(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)+cos(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*(sin(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)+cos(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)).*2.0-(cos(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)-sin(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*(sin(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)-cos(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)).*2.0).*(-1.0./2.0)-(mw.*((sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0))./2.0-Ia_1.*cos(conj(qx)).*sin(qm_L).*(cos(qm_L).^2+sin(qm_L).^2)-Iw_1.*cos(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L)),(ma.*(cos(qy).*(sin(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)-cos(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0-sin(qy).*(sin(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)+cos(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0))./2.0-(mw.*(((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*2.0+((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0))./2.0-Iw_3.*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L))-Iw_1.*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))+Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L))+Ia_3.*cos(qp_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+Ia_2.*sin(qp_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)),(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*2.0-((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0))./2.0-Iw_1.*cos(qf_L).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L)),mw.*(((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*2.0+((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0).*(-1.0./2.0)+Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(cos(qe_L).^2+sin(qe_L).^2),ma.*((sin(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)+cos(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*(sin(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)+cos(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)).*2.0-(cos(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)-sin(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*(sin(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)-cos(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)).*2.0).*(-1.0./2.0)-(mw.*((sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0))./2.0-Ia_1.*cos(conj(qx)).*sin(qm_R).*(cos(qm_R).^2+sin(qm_R).^2)-Iw_1.*cos(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_3.*sin(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R)),(ma.*(cos(qy).*(sin(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)-cos(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0-sin(qy).*(sin(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)+cos(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0))./2.0-(mw.*(((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*2.0+((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0))./2.0-Iw_3.*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R))-Iw_1.*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R))-Ia_3.*cos(qp_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-Ia_2.*sin(qp_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)),(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*2.0-((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0))./2.0-Iw_1.*cos(qf_R).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_3.*sin(qf_R).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R)),mw.*(((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*2.0+((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0).*(-1.0./2.0)-Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(cos(qe_R).^2+sin(qe_R).^2),0.0,0.0,0.0,-Ib_1.*sin(conj(qy))-Ia_1.*cos(qm_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-Ia_1.*cos(qm_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))-Iw_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)))+Iw_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)))+Ia_2.*cos(qp_L).*sin(qm_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))-Ia_2.*cos(qp_R).*sin(qm_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-Ia_3.*sin(qm_L).*sin(qp_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-Ia_3.*sin(qm_R).*sin(qp_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)),Iw_3.*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L)).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R)).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_1.*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))+Iw_1.*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)))+Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)))-Ia_2.*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+Ia_2.*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-Ia_3.*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L)).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-Ia_3.*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R)).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+Ib_2.*cos(conj(qx)).*cos(conj(qy)).*sin(conj(qx))-Ib_3.*cos(conj(qx)).*cos(conj(qy)).*sin(conj(qx))+Ia_1.*cos(conj(qx)).*sin(qm_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-Ia_1.*cos(conj(qx)).*sin(qm_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R)),Ia_2.*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)).^2+Ia_2.*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)).^2+Ia_3.*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)).^2+Ia_3.*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)).^2+Ib_1.*sin(conj(qy)).^2+Iw_3.*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))).^2+Iw_3.*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))).^2+Iw_1.*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))).^2+Iw_1.*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))).^2+Ia_1.*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L)).^2+Ia_1.*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R)).^2+Iw_2.*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))).^2+Iw_2.*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))).^2+Ib_3.*cos(conj(qx)).^2.*cos(conj(qy)).^2+Ib_2.*cos(conj(qy)).^2.*sin(conj(qx)).^2,-Ia_1.*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L)).*(cos(qm_L).^2+sin(qm_L).^2)-Iw_1.*cos(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))),-Iw_2.*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L)).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)))-Iw_3.*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_1.*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Ia_2.*sin(qp_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))-Ia_3.*cos(qp_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)),-Iw_1.*cos(qf_L).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))),-Iw_2.*(cos(qe_L).^2+sin(qe_L).^2).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))),Ia_1.*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R)).*(cos(qm_R).^2+sin(qm_R).^2)-Iw_1.*cos(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_3.*sin(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))),-Iw_2.*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R)).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)))+Iw_3.*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_1.*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Ia_2.*sin(qp_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))+Ia_3.*cos(qp_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)),-Iw_1.*cos(qf_R).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_3.*sin(qf_R).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))),-Iw_2.*(cos(qe_R).^2+sin(qe_R).^2).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))),mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L)).*2.0-L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L)))-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L)).*2.0).*(-1.0./2.0)-(ma.*(cos(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0).*2.0-sin(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0).*2.0))./2.0,mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L))+L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L))+L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L))+L2_L_3.*cos(qm_L).*cos(qp_L).*2.0+L2_L_2.*cos(qm_L).*sin(qp_L).*2.0).*(-1.0./2.0)-(ma.*(L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)))./2.0,(mw.*(-L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))-L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))+L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy)))+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L)).*2.0+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L)).*2.0))./2.0+(ma.*(sin(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0).*2.0+cos(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0).*2.0))./2.0,Ia_1.*cos(qm_L).*(cos(qm_L).^2+sin(qm_L).^2)-Iw_1.*cos(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))+Iw_3.*sin(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)),ma.*((sin(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)+cos(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*(sin(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)+cos(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)).*2.0-(cos(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)-sin(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*(sin(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)-cos(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)).*2.0).*(-1.0./2.0)-(mw.*((sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0))./2.0-Ia_1.*cos(conj(qx)).*sin(qm_L).*(cos(qm_L).^2+sin(qm_L).^2)-Iw_1.*cos(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L)),-Ia_1.*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L)).*(cos(qm_L).^2+sin(qm_L).^2)-Iw_1.*cos(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(cos(qm_L).^2+sin(qm_L).^2).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))),(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0+L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)).^2.*2.0+(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).^2.*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).^2.*2.0))./2.0+(ma.*(((L2_L_3.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_2.*cos(qm_L).*sin(qp_L))./2.0).^2.*2.0+(sin(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)+cos(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).^2.*2.0+(cos(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)-sin(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).^2.*2.0))./2.0+Ia_1.*(cos(qm_L).^2+sin(qm_L).^2).^2+Iw_1.*cos(qf_L).^2.*(cos(qm_L).^2+sin(qm_L).^2).^2+Iw_3.*sin(qf_L).^2.*(cos(qm_L).^2+sin(qm_L).^2).^2,(ma.*(((L2_L_3.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_2.*cos(qm_L).*sin(qp_L))./2.0).*((L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0).*2.0+cos(qy).*(cos(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)-sin(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0+sin(qy).*(sin(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)+cos(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0))./2.0+(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0+L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)).*((L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)))./2.0-L2_L_1.*cos(qm_L)+(L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)))./2.0+(L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)))./2.0-L2_L_2.*cos(qp_L).*sin(qm_L)+L2_L_3.*sin(qm_L).*sin(qp_L)).*-2.0+((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0))./2.0+Iw_3.*sin(qf_L).*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(cos(qm_L).^2+sin(qm_L).^2)+Iw_1.*cos(qf_L).*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(cos(qm_L).^2+sin(qm_L).^2),(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0+L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)).*2.0-((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0))./2.0+Iw_1.*cos(qf_L).^2.*(cos(qm_L).^2+sin(qm_L).^2)+Iw_3.*sin(qf_L).^2.*(cos(qm_L).^2+sin(qm_L).^2),(mw.*(((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0-(L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0+L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)).*2.0))./2.0,0.0,0.0,0.0,0.0,mw.*(L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L))+L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L))-L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L))+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L)).*2.0).*(-1.0./2.0)-ma.*cos(qy).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0),(mw.*(L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L))-L2_L_1.*cos(qm_L).*2.0+L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L))+L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))-L2_L_2.*cos(qp_L).*sin(qm_L).*2.0+L2_L_3.*sin(qm_L).*sin(qp_L).*2.0))./2.0-(ma.*(L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L)))./2.0,(mw.*(L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy))+L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy))-L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy))+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L)).*2.0))./2.0+ma.*sin(qy).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0),Iw_3.*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L))-Iw_1.*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))+Iw_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)).*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L))-Ia_2.*cos(qp_L).*sin(qm_L).*sin(qp_L)+Ia_3.*cos(qp_L).*sin(qm_L).*sin(qp_L),(ma.*(cos(qy).*(sin(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)-cos(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0-sin(qy).*(sin(qy).*(L1_L_3+(L2_L_3.*cos(qp_L))./2.0+(L2_L_2.*sin(qp_L))./2.0)+cos(qy).*(L1_L_1+(L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0))./2.0-(mw.*(((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*2.0+((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0))./2.0-Iw_3.*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L))-Iw_1.*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))+Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L))+Ia_3.*cos(qp_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+Ia_2.*sin(qp_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)),-Iw_2.*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L)).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)))-Iw_3.*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_1.*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Ia_2.*sin(qp_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))-Ia_3.*cos(qp_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L)),(ma.*(((L2_L_3.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_2.*cos(qm_L).*sin(qp_L))./2.0).*((L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0).*2.0+cos(qy).*(cos(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)-sin(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0+sin(qy).*(sin(qy).*((L2_L_3.*cos(qp_L).*sin(qm_L))./2.0+(L2_L_2.*sin(qm_L).*sin(qp_L))./2.0)+cos(qy).*((L2_L_2.*cos(qp_L))./2.0-(L2_L_3.*sin(qp_L))./2.0)).*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).*2.0))./2.0+(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0+L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)).*((L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)))./2.0-L2_L_1.*cos(qm_L)+(L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)))./2.0+(L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)))./2.0-L2_L_2.*cos(qp_L).*sin(qm_L)+L2_L_3.*sin(qm_L).*sin(qp_L)).*-2.0+((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0))./2.0+Iw_3.*sin(qf_L).*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).*(cos(qm_L).^2+sin(qm_L).^2)+Iw_1.*cos(qf_L).*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).*(cos(qm_L).^2+sin(qm_L).^2),Iw_3.*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L)).^2+Iw_1.*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)).^2+Iw_2.*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L)).^2+Ia_3.*cos(qp_L).^2+Ia_2.*sin(qp_L).^2+(ma.*(((L2_L_1.*cos(qm_L))./2.0+(L2_L_2.*cos(qp_L).*sin(qm_L))./2.0-(L2_L_3.*sin(qm_L).*sin(qp_L))./2.0).^2.*2.0+cos(qy).^2.*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).^2.*2.0+sin(qy).^2.*((L2_L_1.*sin(qm_L))./2.0-(L2_L_2.*cos(qm_L).*cos(qp_L))./2.0+(L2_L_3.*cos(qm_L).*sin(qp_L))./2.0).^2.*2.0))./2.0+(mw.*(((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).^2.*2.0+((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).^2.*2.0+((L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)))./2.0-L2_L_1.*cos(qm_L)+(L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)))./2.0+(L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)))./2.0-L2_L_2.*cos(qp_L).*sin(qm_L)+L2_L_3.*sin(qm_L).*sin(qp_L)).^2.*2.0))./2.0,mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0).*((L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)))./2.0-L2_L_1.*cos(qm_L)+(L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)))./2.0+(L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)))./2.0-L2_L_2.*cos(qp_L).*sin(qm_L)+L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0-((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0).*(-1.0./2.0)+Iw_3.*sin(qf_L).*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L))+Iw_1.*cos(qf_L).*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)),(mw.*(((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0-((L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0-(L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L)))./2.0).*((L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)))./2.0-L2_L_1.*cos(qm_L)+(L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)))./2.0+(L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)))./2.0-L2_L_2.*cos(qp_L).*sin(qm_L)+L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0))./2.0+Iw_2.*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L)).*(cos(qe_L).^2+sin(qe_L).^2),0.0,0.0,0.0,0.0,mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L)))-L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L)))).*(-1.0./2.0),mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L))+L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L))+L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L))).*(-1.0./2.0),mw.*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))+L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy)))-L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy)))).*(-1.0./2.0),-Iw_1.*cos(qf_L).*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L))+Iw_3.*sin(qf_L).*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)),(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*2.0-((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0))./2.0-Iw_1.*cos(qf_L).*(cos(qe_L).*sin(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(conj(qx)).*cos(qf_L).*sin(qm_L)-sin(qe_L).*sin(qf_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(-cos(qe_L).*cos(qf_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+cos(conj(qx)).*sin(qf_L).*sin(qm_L)),-Iw_1.*cos(qf_L).*(cos(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))-cos(qe_L).*sin(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))+sin(qe_L).*sin(qf_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L)))-Iw_3.*sin(qf_L).*(sin(qf_L).*(sin(conj(qy)).*cos(qm_L)+cos(conj(qy)).*sin(conj(qx)).*sin(qm_L))+cos(qe_L).*cos(qf_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))-cos(qf_L).*sin(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))),(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0+L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)).*2.0-((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0))./2.0+Iw_1.*cos(qf_L).^2.*(cos(qm_L).^2+sin(qm_L).^2)+Iw_3.*sin(qf_L).^2.*(cos(qm_L).^2+sin(qm_L).^2),mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0).*((L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)))./2.0-L2_L_1.*cos(qm_L)+(L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)))./2.0+(L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)))./2.0-L2_L_2.*cos(qp_L).*sin(qm_L)+L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0-((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0).*(-1.0./2.0)+Iw_3.*sin(qf_L).*(cos(qe_L).*cos(qf_L).*cos(qp_L)-cos(qf_L).*sin(qe_L).*sin(qp_L))+Iw_1.*cos(qf_L).*(sin(qe_L).*sin(qf_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qf_L)),(mw.*(((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).^2.*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).^2.*2.0+((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0).^2.*2.0))./2.0+Iw_1.*cos(qf_L).^2+Iw_3.*sin(qf_L).^2,(mw.*(((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*2.0-((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*2.0+((L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0-(L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0).*2.0))./2.0,0.0,0.0,0.0,0.0,mw.*(L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L))+L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy))).*(-1.0./2.0),mw.*(L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L))-L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L))).*(-1.0./2.0),(mw.*(L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy))+L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy))))./2.0,Iw_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)).*(cos(qe_L).^2+sin(qe_L).^2),mw.*(((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*(sin(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))-(L3_L_3.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0+cos(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0).*2.0+((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_1.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0-sin(qy).*(L1_L_1+L2_L_1.*cos(qm_L)+L2_L_2.*cos(qp_L).*sin(qm_L)-L2_L_3.*sin(qm_L).*sin(qp_L))+(L3_L_2.*(cos(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+cos(qy).*(L1_L_3+L2_L_3.*cos(qp_L)+L2_L_2.*sin(qp_L))).*2.0).*(-1.0./2.0)+Iw_2.*(cos(qe_L).*(sin(conj(qx)).*sin(qp_L)-cos(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qx)).*cos(qp_L)+cos(conj(qx)).*cos(qm_L).*sin(qp_L))).*(cos(qe_L).^2+sin(qe_L).^2),-Iw_2.*(cos(qe_L).^2+sin(qe_L).^2).*(cos(qe_L).*(-sin(conj(qy)).*cos(qp_L).*sin(qm_L)+cos(conj(qx)).*cos(conj(qy)).*sin(qp_L)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*cos(qp_L))+sin(qe_L).*(sin(conj(qy)).*sin(qm_L).*sin(qp_L)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_L)-cos(conj(qy)).*sin(conj(qx)).*cos(qm_L).*sin(qp_L))),(mw.*(((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+cos(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0-sin(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*(L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))).*(-1.0./2.0)-(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0+sin(qy).*(L2_L_3.*cos(qp_L).*sin(qm_L)+L2_L_2.*sin(qm_L).*sin(qp_L))+cos(qy).*(L2_L_2.*cos(qp_L)-L2_L_3.*sin(qp_L))).*2.0+((L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0-(L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0+L2_L_3.*cos(qm_L).*cos(qp_L)+L2_L_2.*cos(qm_L).*sin(qp_L)).*2.0))./2.0,(mw.*(((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(-cos(qy).*sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qy).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L)))./2.0+(L3_L_1.*(cos(qf_L).*cos(qy).*sin(qm_L)+cos(qe_L).*cos(qm_L).*cos(qy).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*cos(qy).*sin(qe_L).*sin(qf_L)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*cos(qy)-cos(qm_L).*cos(qy).*sin(qe_L).*sin(qp_L)))./2.0+cos(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0-((L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0-(L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L)))./2.0).*((L3_L_2.*(sin(qe_L).*sin(qm_L).*sin(qp_L)-cos(qe_L).*cos(qp_L).*sin(qm_L)))./2.0-L2_L_1.*cos(qm_L)+(L3_L_3.*(cos(qm_L).*sin(qf_L)+cos(qe_L).*cos(qf_L).*sin(qm_L).*sin(qp_L)+cos(qf_L).*cos(qp_L).*sin(qe_L).*sin(qm_L)))./2.0+(L3_L_1.*(-cos(qf_L).*cos(qm_L)+cos(qe_L).*sin(qf_L).*sin(qm_L).*sin(qp_L)+cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qm_L)))./2.0-L2_L_2.*cos(qp_L).*sin(qm_L)+L2_L_3.*sin(qm_L).*sin(qp_L)).*2.0+((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*((L3_L_3.*(-sin(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L).*sin(qy)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qy)))./2.0+(L3_L_1.*(cos(qf_L).*sin(qm_L).*sin(qy)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L).*sin(qy)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L).*sin(qy)))./2.0-(L3_L_2.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qy)-cos(qm_L).*sin(qe_L).*sin(qp_L).*sin(qy)))./2.0+sin(qy).*(L2_L_1.*sin(qm_L)-L2_L_2.*cos(qm_L).*cos(qp_L)+L2_L_3.*cos(qm_L).*sin(qp_L))).*2.0))./2.0+Iw_2.*(cos(qe_L).*sin(qp_L)+cos(qp_L).*sin(qe_L)).*(cos(qe_L).^2+sin(qe_L).^2),(mw.*(((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))))./2.0).*2.0-((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*sin(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0+(L3_L_1.*(cos(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))))./2.0-(L3_L_2.*(cos(qe_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))))./2.0).*2.0+((L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0-(L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L)))./2.0).*((L3_L_3.*(cos(qe_L).*cos(qf_L).*cos(qm_L).*cos(qp_L)-cos(qf_L).*cos(qm_L).*sin(qe_L).*sin(qp_L)))./2.0+(L3_L_1.*(cos(qe_L).*cos(qm_L).*cos(qp_L).*sin(qf_L)-cos(qm_L).*sin(qe_L).*sin(qf_L).*sin(qp_L)))./2.0+(L3_L_2.*(cos(qe_L).*cos(qm_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0).*2.0))./2.0,(mw.*(((L3_L_1.*(-sin(qf_L).*sin(qm_L)+cos(qe_L).*cos(qf_L).*cos(qm_L).*sin(qp_L)+cos(qf_L).*cos(qm_L).*cos(qp_L).*sin(qe_L)))./2.0-(L3_L_3.*(cos(qf_L).*sin(qm_L)+cos(qe_L).*cos(qm_L).*sin(qf_L).*sin(qp_L)+cos(qm_L).*cos(qp_L).*sin(qe_L).*sin(qf_L)))./2.0).^2.*2.0+((L3_L_1.*(-cos(qe_L).*cos(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))+cos(qf_L).*sin(qe_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qm_L).*cos(qy).*sin(qf_L)))./2.0+(L3_L_3.*(cos(qe_L).*sin(qf_L).*(cos(qp_L).*sin(qy)-cos(qy).*sin(qm_L).*sin(qp_L))-sin(qe_L).*sin(qf_L).*(sin(qp_L).*sin(qy)+cos(qp_L).*cos(qy).*sin(qm_L))+cos(qf_L).*cos(qm_L).*cos(qy)))./2.0).^2.*2.0+((L3_L_1.*(cos(qe_L).*cos(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))-cos(qf_L).*sin(qe_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qm_L).*sin(qf_L).*sin(qy)))./2.0+(L3_L_3.*(-cos(qe_L).*sin(qf_L).*(cos(qp_L).*cos(qy)+sin(qm_L).*sin(qp_L).*sin(qy))+sin(qe_L).*sin(qf_L).*(cos(qy).*sin(qp_L)-cos(qp_L).*sin(qm_L).*sin(qy))+cos(qf_L).*cos(qm_L).*sin(qy)))./2.0).^2.*2.0))./2.0+Iw_2.*(cos(qe_L).^2+sin(qe_L).^2).^2,0.0,0.0,0.0,0.0,mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R)).*2.0-L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R)))-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R)).*2.0).*(-1.0./2.0)-(ma.*(cos(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0).*2.0-sin(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0).*2.0))./2.0,(mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R))+L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R))+L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R))+L2_R_3.*cos(qm_R).*cos(qp_R).*2.0+L2_R_2.*cos(qm_R).*sin(qp_R).*2.0))./2.0+(ma.*(L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)))./2.0,(mw.*(-L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))-L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))+L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy)))+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R)).*2.0+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R)).*2.0))./2.0+(ma.*(sin(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0).*2.0+cos(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0).*2.0))./2.0,-Ia_1.*cos(qm_R).*(cos(qm_R).^2+sin(qm_R).^2)+Iw_1.*cos(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-Iw_3.*sin(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)),ma.*((sin(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)+cos(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*(sin(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)+cos(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)).*2.0-(cos(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)-sin(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*(sin(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)-cos(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)).*2.0).*(-1.0./2.0)-(mw.*((sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0))./2.0-Ia_1.*cos(conj(qx)).*sin(qm_R).*(cos(qm_R).^2+sin(qm_R).^2)-Iw_1.*cos(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_3.*sin(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R)),Ia_1.*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R)).*(cos(qm_R).^2+sin(qm_R).^2)-Iw_1.*cos(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_3.*sin(qf_R).*(cos(qm_R).^2+sin(qm_R).^2).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))),0.0,0.0,0.0,0.0,(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0+L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)).^2.*2.0+(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).^2.*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).^2.*2.0))./2.0+(ma.*(((L2_R_3.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_2.*cos(qm_R).*sin(qp_R))./2.0).^2.*2.0+(sin(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)+cos(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).^2.*2.0+(cos(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)-sin(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).^2.*2.0))./2.0+Ia_1.*(cos(qm_R).^2+sin(qm_R).^2).^2+Iw_1.*cos(qf_R).^2.*(cos(qm_R).^2+sin(qm_R).^2).^2+Iw_3.*sin(qf_R).^2.*(cos(qm_R).^2+sin(qm_R).^2).^2,(ma.*(((L2_R_3.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_2.*cos(qm_R).*sin(qp_R))./2.0).*((L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0).*2.0+cos(qy).*(cos(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)-sin(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0+sin(qy).*(sin(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)+cos(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0))./2.0+(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0+L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)).*((L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)))./2.0-L2_R_1.*cos(qm_R)+(L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)))./2.0+(L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)))./2.0-L2_R_2.*cos(qp_R).*sin(qm_R)+L2_R_3.*sin(qm_R).*sin(qp_R)).*-2.0+((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0))./2.0+Iw_3.*sin(qf_R).*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(cos(qm_R).^2+sin(qm_R).^2)+Iw_1.*cos(qf_R).*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(cos(qm_R).^2+sin(qm_R).^2),(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0+L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)).*2.0-((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0))./2.0+Iw_1.*cos(qf_R).^2.*(cos(qm_R).^2+sin(qm_R).^2)+Iw_3.*sin(qf_R).^2.*(cos(qm_R).^2+sin(qm_R).^2),(mw.*(((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0-(L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0+L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)).*2.0))./2.0,mw.*(L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R))+L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R))-L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R))+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R)).*2.0).*(-1.0./2.0)-ma.*cos(qy).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0),mw.*(L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R))-L2_R_1.*cos(qm_R).*2.0+L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R))+L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-L2_R_2.*cos(qp_R).*sin(qm_R).*2.0+L2_R_3.*sin(qm_R).*sin(qp_R).*2.0).*(-1.0./2.0)+(ma.*(L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R)))./2.0,(mw.*(L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy))+L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy))-L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy))+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R)).*2.0))./2.0+ma.*sin(qy).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0),-Iw_3.*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R))+Iw_1.*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-Iw_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)).*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R))+Ia_2.*cos(qp_R).*sin(qm_R).*sin(qp_R)-Ia_3.*cos(qp_R).*sin(qm_R).*sin(qp_R),(ma.*(cos(qy).*(sin(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)-cos(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0-sin(qy).*(sin(qy).*(L1_R_3+(L2_R_3.*cos(qp_R))./2.0+(L2_R_2.*sin(qp_R))./2.0)+cos(qy).*(L1_R_1+(L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0))./2.0-(mw.*(((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*2.0+((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0))./2.0-Iw_3.*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R))-Iw_1.*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R))-Ia_3.*cos(qp_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-Ia_2.*sin(qp_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)),-Iw_2.*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R)).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)))+Iw_3.*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_1.*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))-Ia_2.*sin(qp_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))+Ia_3.*cos(qp_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R)),0.0,0.0,0.0,0.0,(ma.*(((L2_R_3.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_2.*cos(qm_R).*sin(qp_R))./2.0).*((L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0).*2.0+cos(qy).*(cos(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)-sin(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0+sin(qy).*(sin(qy).*((L2_R_3.*cos(qp_R).*sin(qm_R))./2.0+(L2_R_2.*sin(qm_R).*sin(qp_R))./2.0)+cos(qy).*((L2_R_2.*cos(qp_R))./2.0-(L2_R_3.*sin(qp_R))./2.0)).*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).*2.0))./2.0+(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0+L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)).*((L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)))./2.0-L2_R_1.*cos(qm_R)+(L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)))./2.0+(L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)))./2.0-L2_R_2.*cos(qp_R).*sin(qm_R)+L2_R_3.*sin(qm_R).*sin(qp_R)).*-2.0+((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0))./2.0+Iw_3.*sin(qf_R).*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).*(cos(qm_R).^2+sin(qm_R).^2)+Iw_1.*cos(qf_R).*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).*(cos(qm_R).^2+sin(qm_R).^2),Iw_3.*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R)).^2+Iw_1.*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)).^2+Iw_2.*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R)).^2+Ia_3.*cos(qp_R).^2+Ia_2.*sin(qp_R).^2+(ma.*(((L2_R_1.*cos(qm_R))./2.0+(L2_R_2.*cos(qp_R).*sin(qm_R))./2.0-(L2_R_3.*sin(qm_R).*sin(qp_R))./2.0).^2.*2.0+cos(qy).^2.*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).^2.*2.0+sin(qy).^2.*((L2_R_1.*sin(qm_R))./2.0-(L2_R_2.*cos(qm_R).*cos(qp_R))./2.0+(L2_R_3.*cos(qm_R).*sin(qp_R))./2.0).^2.*2.0))./2.0+(mw.*(((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).^2.*2.0+((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).^2.*2.0+((L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)))./2.0-L2_R_1.*cos(qm_R)+(L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)))./2.0+(L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)))./2.0-L2_R_2.*cos(qp_R).*sin(qm_R)+L2_R_3.*sin(qm_R).*sin(qp_R)).^2.*2.0))./2.0,mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0).*((L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)))./2.0-L2_R_1.*cos(qm_R)+(L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)))./2.0+(L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)))./2.0-L2_R_2.*cos(qp_R).*sin(qm_R)+L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0-((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0).*(-1.0./2.0)+Iw_3.*sin(qf_R).*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R))+Iw_1.*cos(qf_R).*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)),(mw.*(((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0-((L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0-(L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R)))./2.0).*((L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)))./2.0-L2_R_1.*cos(qm_R)+(L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)))./2.0+(L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)))./2.0-L2_R_2.*cos(qp_R).*sin(qm_R)+L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0))./2.0+Iw_2.*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R)).*(cos(qe_R).^2+sin(qe_R).^2),mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R)))-L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R)))).*(-1.0./2.0),(mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R))+L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R))+L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R))))./2.0,mw.*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))+L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy)))-L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy)))).*(-1.0./2.0),Iw_1.*cos(qf_R).*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R))-Iw_3.*sin(qf_R).*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)),(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*2.0-((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0))./2.0-Iw_1.*cos(qf_R).*(-cos(qe_R).*sin(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(conj(qx)).*cos(qf_R).*sin(qm_R)+sin(qe_R).*sin(qf_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R)))-Iw_3.*sin(qf_R).*(cos(qe_R).*cos(qf_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))-cos(qf_R).*sin(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+cos(conj(qx)).*sin(qf_R).*sin(qm_R)),-Iw_1.*cos(qf_R).*(-cos(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*sin(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+sin(qe_R).*sin(qf_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R)))+Iw_3.*sin(qf_R).*(sin(qf_R).*(sin(conj(qy)).*cos(qm_R)-cos(conj(qy)).*sin(conj(qx)).*sin(qm_R))+cos(qe_R).*cos(qf_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))),0.0,0.0,0.0,0.0,(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0+L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)).*2.0-((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0))./2.0+Iw_1.*cos(qf_R).^2.*(cos(qm_R).^2+sin(qm_R).^2)+Iw_3.*sin(qf_R).^2.*(cos(qm_R).^2+sin(qm_R).^2),mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0).*((L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)))./2.0-L2_R_1.*cos(qm_R)+(L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)))./2.0+(L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)))./2.0-L2_R_2.*cos(qp_R).*sin(qm_R)+L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0-((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0).*(-1.0./2.0)+Iw_3.*sin(qf_R).*(cos(qe_R).*cos(qf_R).*cos(qp_R)-cos(qf_R).*sin(qe_R).*sin(qp_R))+Iw_1.*cos(qf_R).*(sin(qe_R).*sin(qf_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qf_R)),(mw.*(((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).^2.*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).^2.*2.0+((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0).^2.*2.0))./2.0+Iw_1.*cos(qf_R).^2+Iw_3.*sin(qf_R).^2,(mw.*(((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*2.0-((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*2.0+((L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0-(L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0).*2.0))./2.0,mw.*(L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R))+L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy))).*(-1.0./2.0),(mw.*(L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R))-L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R))))./2.0,(mw.*(L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy))+L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy))))./2.0,-Iw_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)).*(cos(qe_R).^2+sin(qe_R).^2),mw.*(((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*(sin(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))-(L3_R_3.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0+cos(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0).*2.0+((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_1.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0-sin(qy).*(L1_R_1+L2_R_1.*cos(qm_R)+L2_R_2.*cos(qp_R).*sin(qm_R)-L2_R_3.*sin(qm_R).*sin(qp_R))+(L3_R_2.*(cos(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+cos(qy).*(L1_R_3+L2_R_3.*cos(qp_R)+L2_R_2.*sin(qp_R))).*2.0).*(-1.0./2.0)-Iw_2.*(cos(qe_R).*(sin(conj(qx)).*sin(qp_R)+cos(conj(qx)).*cos(qm_R).*cos(qp_R))+sin(qe_R).*(sin(conj(qx)).*cos(qp_R)-cos(conj(qx)).*cos(qm_R).*sin(qp_R))).*(cos(qe_R).^2+sin(qe_R).^2),-Iw_2.*(cos(qe_R).^2+sin(qe_R).^2).*(cos(qe_R).*(sin(conj(qy)).*cos(qp_R).*sin(qm_R)-cos(conj(qx)).*cos(conj(qy)).*sin(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*cos(qp_R))-sin(qe_R).*(sin(conj(qy)).*sin(qm_R).*sin(qp_R)+cos(conj(qx)).*cos(conj(qy)).*cos(qp_R)+cos(conj(qy)).*sin(conj(qx)).*cos(qm_R).*sin(qp_R))),0.0,0.0,0.0,0.0,(mw.*(((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+cos(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0-sin(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*(L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))).*(-1.0./2.0)-(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0+sin(qy).*(L2_R_3.*cos(qp_R).*sin(qm_R)+L2_R_2.*sin(qm_R).*sin(qp_R))+cos(qy).*(L2_R_2.*cos(qp_R)-L2_R_3.*sin(qp_R))).*2.0+((L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0-(L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0+L2_R_3.*cos(qm_R).*cos(qp_R)+L2_R_2.*cos(qm_R).*sin(qp_R)).*2.0))./2.0,(mw.*(((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(-cos(qy).*sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qy).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R)))./2.0+(L3_R_1.*(cos(qf_R).*cos(qy).*sin(qm_R)+cos(qe_R).*cos(qm_R).*cos(qy).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*cos(qy).*sin(qe_R).*sin(qf_R)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*cos(qy)-cos(qm_R).*cos(qy).*sin(qe_R).*sin(qp_R)))./2.0+cos(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0-((L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0-(L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R)))./2.0).*((L3_R_2.*(sin(qe_R).*sin(qm_R).*sin(qp_R)-cos(qe_R).*cos(qp_R).*sin(qm_R)))./2.0-L2_R_1.*cos(qm_R)+(L3_R_3.*(cos(qm_R).*sin(qf_R)+cos(qe_R).*cos(qf_R).*sin(qm_R).*sin(qp_R)+cos(qf_R).*cos(qp_R).*sin(qe_R).*sin(qm_R)))./2.0+(L3_R_1.*(-cos(qf_R).*cos(qm_R)+cos(qe_R).*sin(qf_R).*sin(qm_R).*sin(qp_R)+cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qm_R)))./2.0-L2_R_2.*cos(qp_R).*sin(qm_R)+L2_R_3.*sin(qm_R).*sin(qp_R)).*2.0+((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*((L3_R_3.*(-sin(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R).*sin(qy)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qy)))./2.0+(L3_R_1.*(cos(qf_R).*sin(qm_R).*sin(qy)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R).*sin(qy)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R).*sin(qy)))./2.0-(L3_R_2.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qy)-cos(qm_R).*sin(qe_R).*sin(qp_R).*sin(qy)))./2.0+sin(qy).*(L2_R_1.*sin(qm_R)-L2_R_2.*cos(qm_R).*cos(qp_R)+L2_R_3.*cos(qm_R).*sin(qp_R))).*2.0))./2.0+Iw_2.*(cos(qe_R).*sin(qp_R)+cos(qp_R).*sin(qe_R)).*(cos(qe_R).^2+sin(qe_R).^2),(mw.*(((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))))./2.0).*2.0-((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*sin(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0+(L3_R_1.*(cos(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))))./2.0-(L3_R_2.*(cos(qe_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))))./2.0).*2.0+((L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0-(L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R)))./2.0).*((L3_R_3.*(cos(qe_R).*cos(qf_R).*cos(qm_R).*cos(qp_R)-cos(qf_R).*cos(qm_R).*sin(qe_R).*sin(qp_R)))./2.0+(L3_R_1.*(cos(qe_R).*cos(qm_R).*cos(qp_R).*sin(qf_R)-cos(qm_R).*sin(qe_R).*sin(qf_R).*sin(qp_R)))./2.0+(L3_R_2.*(cos(qe_R).*cos(qm_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0).*2.0))./2.0,(mw.*(((L3_R_1.*(-sin(qf_R).*sin(qm_R)+cos(qe_R).*cos(qf_R).*cos(qm_R).*sin(qp_R)+cos(qf_R).*cos(qm_R).*cos(qp_R).*sin(qe_R)))./2.0-(L3_R_3.*(cos(qf_R).*sin(qm_R)+cos(qe_R).*cos(qm_R).*sin(qf_R).*sin(qp_R)+cos(qm_R).*cos(qp_R).*sin(qe_R).*sin(qf_R)))./2.0).^2.*2.0+((L3_R_1.*(-cos(qe_R).*cos(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))+cos(qf_R).*sin(qe_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qm_R).*cos(qy).*sin(qf_R)))./2.0+(L3_R_3.*(cos(qe_R).*sin(qf_R).*(cos(qp_R).*sin(qy)-cos(qy).*sin(qm_R).*sin(qp_R))-sin(qe_R).*sin(qf_R).*(sin(qp_R).*sin(qy)+cos(qp_R).*cos(qy).*sin(qm_R))+cos(qf_R).*cos(qm_R).*cos(qy)))./2.0).^2.*2.0+((L3_R_1.*(cos(qe_R).*cos(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))-cos(qf_R).*sin(qe_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qm_R).*sin(qf_R).*sin(qy)))./2.0+(L3_R_3.*(-cos(qe_R).*sin(qf_R).*(cos(qp_R).*cos(qy)+sin(qm_R).*sin(qp_R).*sin(qy))+sin(qe_R).*sin(qf_R).*(cos(qy).*sin(qp_R)-cos(qp_R).*sin(qm_R).*sin(qy))+cos(qf_R).*cos(qm_R).*sin(qy)))./2.0).^2.*2.0))./2.0+Iw_2.*(cos(qe_R).^2+sin(qe_R).^2).^2],[14,14]);
